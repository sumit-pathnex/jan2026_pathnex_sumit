     #   Day 17 - Loops, ALB, Namespace, Top Processes

     ##   Ansible - Create Multiple Users in Loop

     ---
     - name: Create multiple Pathnex users
       hosts: all
       become: yes

       vars:
          users:
	     - dev1
	     - dev2
	     - dev3

       tasks:
         - name: Create users
	   user:
	     name: "{{item}}"
	     state: present
	   loop: "{{users}}"


     ##   Terraform - Application Load Balancer

     resource "aws_lb" "sumit-pathnexALB" {
       name               = "sumit-pathnex-ALB"
       load_balancer_type = "application"
       subnets            = [aws_subnet.sumit-pathnexSubnet.id]

       tags: {
         Name = "sumit-pathnex-ALB"
       }
     }


     ##   Kubernetes - Namespace + Deployment

     apiVersion: v1
     kind: Namespace
     metadata:
        name: pathnex-namespace


     ---
     apiVersion: apps/v1
     kind: Deployment
     metadata:
       name: sumit-pathnex-namespace
     spec:
       replicas: 2
       selector:
         metadata:
	   labels:
	     app: sumit-pathnex
	   spec:
	     containers:
	       - name: app
	         image: nginx

    
    ##   Shell Script - Top 5 Memory Processes

    #!/bin/bash

    ps aux --sort=%mem | head -n 6



    # Deployment Simulation

    ##   Jenkins Pipeline - Simulated Deployment


    pipeline {
        agent any
	parameters {
	    choice(name: 'ENVIRONMENT',Choices:['dev,'staging','prod'], description: 'Deployment Environment')
        }
	environment {
	   INSTITUTE_NAME = "sumit-pathnex"
	}
	stages {
	   stage('Deploy') {
	       steps {
	           sh 'echo "Deploying $INSTITUTE_NEME_ application to $ENVIRONMENT"'
	       }
	   }
        }
    }

    ##    GitLab CI - Deployment Simulation


    stages:
       - deploy


    variable:
      INSTITUTE_NAME: "sumit-pathnex"
      ENVIRONMENT: "staging"

    deploy:
      stage: deploy
      image: alpine:latest
      script:
         - echo "Deploying $INSTITUTE_NAME application to $ENVIRONMENT"
